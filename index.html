<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Question to JSON Converter — User Guide</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-inner">
            <div class="logo">
                <i data-lucide="book-open" class="logo-icon"></i>
                <span class="logo-text">Question to JSON Converter</span>
            </div>
            <nav class="nav-links">
                <a href="#overview"><i data-lucide="layout" class="nav-icon"></i>Overview</a>
                <a href="#settings"><i data-lucide="settings" class="nav-icon"></i>Settings</a>
                <a href="#formats"><i data-lucide="file-code" class="nav-icon"></i>Question Formats</a>
                <a href="#editor"><i data-lucide="edit-3" class="nav-icon"></i>Editor</a>
                <a href="#preview"><i data-lucide="eye" class="nav-icon"></i>Preview</a>
                <a href="#media"><i data-lucide="image" class="nav-icon"></i>Media</a>
                <a href="#export"><i data-lucide="download" class="nav-icon"></i>Export</a>
                <a href="#troubleshooting"><i data-lucide="help-circle" class="nav-icon"></i>Troubleshooting</a>
                <a href="#links"><i data-lucide="link" class="nav-icon"></i>Links</a>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1 class="hero-title">User Guide</h1>
            <p class="hero-tagline">For every user. In every project.</p>
            <p class="hero-desc">This comprehensive guide helps you use the Question to JSON converter with ease. From section setup to final export, you'll find everything you need here.</p>
        </div>
        <div class="hero-decoration">
            <i data-lucide="check-circle" class="float-icon"></i>
            <i data-lucide="book-open" class="float-icon"></i>
            <i data-lucide="graduation-cap" class="float-icon"></i>
        </div>
        <div class="hero-wave"></div>
    </section>

    <!-- Filter / Quick Nav -->
    <div class="filter-bar">
        <button class="filter-btn active"><i data-lucide="layout-grid" class="btn-icon"></i>All Sections</button>
        <button class="filter-btn" data-section="overview"><i data-lucide="layout" class="btn-icon"></i>Overview</button>
        <button class="filter-btn" data-section="settings"><i data-lucide="settings" class="btn-icon"></i>Settings</button>
        <button class="filter-btn" data-section="formats"><i data-lucide="file-code" class="btn-icon"></i>Question Formats</button>
        <button class="filter-btn" data-section="editor"><i data-lucide="edit-3" class="btn-icon"></i>Editor</button>
        <button class="filter-btn" data-section="preview"><i data-lucide="eye" class="btn-icon"></i>Preview</button>
        <button class="filter-btn" data-section="media"><i data-lucide="image" class="btn-icon"></i>Media</button>
        <button class="filter-btn" data-section="export"><i data-lucide="download" class="btn-icon"></i>Export</button>
        <button class="filter-btn" data-section="troubleshooting"><i data-lucide="help-circle" class="btn-icon"></i>Troubleshooting</button>
        <button class="filter-btn" data-section="links"><i data-lucide="link" class="btn-icon"></i>Links</button>
    </div>

    <!-- Main Content -->
    <main class="content">
        
        <!-- Section 2: Overview -->
        <section id="overview" class="card section-card">
            <div class="card-number">2</div>
            <h2>Interface Overview</h2>
            <p>This guide provides a comprehensive overview of the <strong>Question to JSON Converter</strong> interface to help you navigate its sections with ease. Especially useful for new users.</p>
            
            <h3>Before You Start</h3>
            <div class="callout callout-info">
                <i data-lucide="info" class="callout-icon"></i>
                <div class="callout-content">
                    <ul class="list-with-icons">
                        <li><i data-lucide="check" class="list-icon"></i><span>The interface supports <strong>Arabic</strong> and <strong>English</strong> (use the <i data-lucide="globe" class="inline-icon"></i> button to switch language).</span></li>
                        <li><i data-lucide="check" class="list-icon"></i><span>Core workflow: Section setup ← Enter questions ← Preview ← Export.</span></li>
                        <li><i data-lucide="alert-triangle" class="list-icon"></i><span><strong>Do not skip the Preview step</strong> before Export; the button will show an error message.</span></li>
                    </ul>
                </div>
            </div>

            <h3>General Layout</h3>
            <div class="diagram-box structure-frame">
                <img src="assts/interface.jpg" alt="General layout - Header, left panel (input), right panel (preview)" class="structure-img">
            </div>

            <h3>0. Message Area</h3>
            <p>At the top of the page (above the main content) <strong>system messages</strong> appear (success, warning, error), e.g.:</p>
            <ul>
                <li>"JSON copied successfully"</li>
                <li>"Please analyze questions first"</li>
                <li>"Settings saved"</li>
            </ul>
            <p>These messages disappear automatically after a few seconds.</p>

            <h3>1. Header</h3>
            <p>At the top of the page you'll find:</p>
            <ul>
                <li><strong>Title:</strong> Advanced Smart Question Converter</li>
                <li><strong>Description:</strong> Convert question text to advanced JSON format with one click</li>
            </ul>

            <h3>2. Left Panel (Input Panel)</h3>
            <p><strong>① Select Subject &amp; Settings</strong> — Section for configuring the subject and basic data:</p>
            <ul>
                <li><strong>Section ID:</strong> Input field for the section identifier</li>
                <li><strong>Fetch button:</strong> To automatically fetch section data (Subject, Grade, Title)</li>
                <li><strong>Data display:</strong> Appears after fetching (Subject, Grade, Section)</li>
                <li><strong>Arabic Section ID:</strong> Shown for bilingual subjects</li>
            </ul>
            <p><strong>② Enter Text</strong> — Main text editor for writing or pasting questions. Separate questions with <code>---</code>.</p>

            <h3>3. Main Control Buttons</h3>
            <div class="diagram-box structure-frame">
                <img src="assts/control_puten.png" alt="Main control buttons - Create AI Questions, Preview Questions, Smart Tags, Create JSON File, Export Package, Manage Tags, Clear Fields" class="structure-img">
            </div>
            <h4>Logical Button Order</h4>
            <div class="callout callout-warning">
                <i data-lucide="alert-triangle" class="callout-icon"></i>
                <p class="callout-content"><strong>Export Package</strong> remains disabled until you successfully press <strong>Preview Questions</strong>.</p>
            </div>
            <h4>Auto-save</h4>
            <div class="callout callout-tip">
                <i data-lucide="lightbulb" class="callout-icon"></i>
                <ul class="callout-content list-with-icons">
                    <li><i data-lucide="check" class="list-icon"></i><span>Editor content is auto-saved in the browser (LocalStorage).</span></li>
                    <li><i data-lucide="check" class="list-icon"></i><span>Content may reload when you reopen the page.</span></li>
                    <li><i data-lucide="alert-triangle" class="list-icon"></i><span><strong>Clear Fields</strong> clears content and cannot be undone.</span></li>
                </ul>
            </div>

            <h3>4. Right Panel (Preview Panel)</h3>
            <ul>
                <li><strong>Title:</strong> Question Preview</li>
                <li><strong>Live Preview button:</strong> To preview questions with Nagwa engine (activates after analysis)</li>
                <li>Analyzed questions appear after pressing <strong>Preview Questions</strong></li>
                <li>You can change each question's type from the dropdown in the preview</li>
            </ul>

            <h3>5. Loading Indicator</h3>
            <p>During analysis or AI generation, a <strong>loading indicator</strong> appears with a message like "Analyzing..." or "Generating...".</p>

            <h3>Core Workflow</h3>
            <div class="diagram-box structure-frame">
                <img src="assts/workflow.jpg" alt="Core workflow - Enter Section ID, write questions, preview, export" class="structure-img">
            </div>
        </section>

        <!-- Section 3: Settings -->
        <section id="settings" class="card section-card">
            <div class="card-number">3</div>
            <h2>Section Setup and Basic Data</h2>
            
            <h3>What is Section ID?</h3>
            <p><strong>Section ID</strong> is a unique numeric identifier representing a specific section within the curriculum on the Nagwa QMS platform (e.g., a chapter or unit in a subject).</p>
            <p>Example: <code>686175817891</code> — derived from the section URL on the Nagwa platform.</p>

            <h3>How to Set Up</h3>
            <ol>
                <li>In the <strong>① Select Subject &amp; Settings</strong> section, enter the section ID in the Section ID field</li>
                <li>Press the <strong><i data-lucide="download" class="inline-icon"></i> Fetch</strong> button</li>
                <li>Data is fetched from the Nagwa API and displays: <strong><i data-lucide="book-open" class="inline-icon"></i> Subject</strong>, <strong><i data-lucide="graduation-cap" class="inline-icon"></i> Grade</strong>, <strong><i data-lucide="book-marked" class="inline-icon"></i> Section</strong> (section title)</li>
                <li>This data is used automatically when creating JSON, exporting ZIP, and filling export fields</li>
            </ol>

            <h3>Arabic Section ID</h3>
            <p>For bilingual subjects (e.g., English or Discover): The <strong><i data-lucide="globe" class="inline-icon"></i> Arabic Section ID</strong> field appears. Enter it and press Fetch. Subject AR, Grade AR, and Section AR data will show. A warning appears if the grade differs between English and Arabic.</p>

            <h3>Hidden Fields</h3>
            <div class="table-wrap">
                <table class="content-table">
                    <thead><tr><th><i data-lucide="list" class="inline-icon"></i> Field</th><th><i data-lucide="file-text" class="inline-icon"></i> Description</th><th><i data-lucide="settings" class="inline-icon"></i> Default Value</th></tr></thead>
                    <tbody>
                        <tr><td>Subject</td><td>Subject name</td><td>From Fetch data</td></tr>
                        <tr><td>Grade</td><td>Grade (1–12)</td><td>From Fetch data</td></tr>
                        <tr><td>Source</td><td>Question source</td><td>nagwa</td></tr>
                        <tr><td>Language</td><td>Content language</td><td>en / ar</td></tr>
                        <tr><td>Country</td><td>Country</td><td>eg</td></tr>
                    </tbody>
                </table>
            </div>

            <h3>When Do I Need Fetch?</h3>
            <ul>
                <li>When starting new work for a specific section</li>
                <li>When switching to a different section</li>
                <li>To verify export data before Create JSON or Export Package</li>
            </ul>

            <h3>Where to Find Section ID</h3>
            <ul>
                <li>From the section URL on the Nagwa platform</li>
                <li>From the content management interface</li>
                <li>From the content team or administrator</li>
            </ul>

            <h3>Technical Notes</h3>
            <ul>
                <li>Fetch requires an internet connection and the proxy server to be running</li>
                <li>Section ID must be a valid number (e.g., 686175817891)</li>
                <li>Grade matching: If a grade conflict warning appears, ensure the same grade is selected for both English and Arabic sections</li>
                <li>What if Fetch fails? Hidden fields are only populated by Fetch. If Fetch fails, see the Troubleshooting section.</li>
            </ul>
        </section>

        <!-- Section 4: Formats -->
        <section id="formats" class="card section-card">
            <div class="card-number">4</div>
            <h2>Text Input and Question Formats</h2>
            
            <h3>Basic Rules</h3>
            <ul>
                <li><strong>Separating questions:</strong> Use <code>---</code> as a separator between each question</li>
                <li><strong>Tags:</strong> <code>@STEM</code>, <code>@CHOICES</code>, <code>@ANSWER</code>, <code>@MATCHING_PAIRS</code>, <code>@GAPS</code>, <code>@BLANK</code>, <code>@STATEMENT</code>, <code>@PART</code></li>
                <li><strong>Answer markers:</strong> <code>*</code> for correct answer in MCQ/MRQ and Gap Fill, <code>-</code> for incorrect</li>
                <li><strong>Line order:</strong> Write <code>type:</code> on the first line usually. After <code>@CHOICES</code> each line = one choice (starts with <code>*</code> or <code>-</code>). Do not add unnecessary blank lines inside a single question block.</li>
            </ul>

            <h3>Beginner Tip</h3>
            <p>Start with a simple MCQ:</p>
            <pre class="code-block">type: mcq
@STEM
What is the capital of Egypt?
@CHOICES
* Cairo
- Alexandria
- Giza
---</pre>

            <h3>Question Types and Formats</h3>
            <p class="format-hint">Click any card to view the structure and example</p>
            <div class="formats-grid interactive">
                <div class="format-card" data-type="mcq">
                    <div class="format-card-header">
                        <span class="format-type">MCQ</span>
                        <span class="format-ar">(Multiple Choice)</span>
                    </div>
                    <p class="format-desc">Single correct answer with <span class="tag">*</span></p>
                    <div class="format-detail">
                        <h4>Structure</h4>
                        <pre>type: mcq
@STEM
&lt;question&gt;
@CHOICES
* &lt;correct answer&gt;
- &lt;distractor 1&gt;
- &lt;distractor 2&gt;
- &lt;distractor 3&gt;</pre>
                        <h4>Example</h4>
                        <pre>type: mcq
@STEM
Which planet is known as the "Red Planet"?
@CHOICES
* Mars
- Venus
- Jupiter
- Saturn</pre>
                    </div>
                </div>
                <div class="format-card" data-type="mrq">
                    <div class="format-card-header">
                        <span class="format-type">MRQ</span>
                        <span class="format-ar">(Multiple Response)</span>
                    </div>
                    <p class="format-desc">Multiple correct answers with <span class="tag">*</span></p>
                    <div class="format-detail">
                        <h4>Structure</h4>
                        <pre>type: mrq
@STEM
&lt;question&gt;
@CHOICES
* &lt;correct answer 1&gt;
* &lt;correct answer 2&gt;
- &lt;distractor 1&gt;
- &lt;distractor 2&gt;</pre>
                        <h4>Example</h4>
                        <pre>type: mrq
@STEM
Which of the following are primary colors?
@CHOICES
* Red
* Blue
* Yellow
- Green
- Purple</pre>
                    </div>
                </div>
                <div class="format-card" data-type="string">
                    <div class="format-card-header">
                        <span class="format-type">String</span>
                        <span class="format-ar">(Short Answer)</span>
                    </div>
                    <p class="format-desc">Use <span class="tag">@ANSWER</span></p>
                    <div class="format-detail">
                        <h4>Structure</h4>
                        <pre>type: string
@STEM
&lt;short answer question&gt;
@ANSWER &lt;model answer&gt;
@GUIDELINES
&lt;exact model answer&gt; - 1 - Correct answer
&lt;completely incorrect answer&gt; - 0 - Incorrect answer.</pre>
                        <h4>Example</h4>
                        <pre>type: string
@STEM
Briefly explain why the sky appears blue during the day.
@ANSWER Rayleigh scattering causes shorter wavelengths of light (blue) to scatter more than longer wavelengths.
@GUIDELINES
The sky is blue because of Rayleigh scattering. - 1 - Correct answer.
Light reflects off the ocean. - 0 - Incorrect scientific explanation.</pre>
                    </div>
                </div>
                <div class="format-card" data-type="matching">
                    <div class="format-card-header">
                        <span class="format-type">Matching</span>
                        <span class="format-ar">(Matching)</span>
                    </div>
                    <p class="format-desc">Pairs separated by | in <span class="tag">@MATCHING_PAIRS</span></p>
                    <div class="format-detail">
                        <h4>Structure</h4>
                        <pre>type: matching
@STEM
&lt;question&gt;
@MATCHING_PAIRS
&lt;item A1&gt; | &lt;item B1&gt;
&lt;item A2&gt; | &lt;item B2&gt;
&lt;item A3&gt; | &lt;item B3&gt;</pre>
                        <h4>Example</h4>
                        <pre>type: matching
@STEM
Match the capital city to its country.
@MATCHING_PAIRS
Paris | France
Tokyo | Japan
Cairo | Egypt</pre>
                    </div>
                </div>
                <div class="format-card" data-type="ordering">
                    <div class="format-card-header">
                        <span class="format-type">Ordering</span>
                        <span class="format-ar">(Ordering)</span>
                    </div>
                    <p class="format-desc">With <span class="tag">@CHOICES</span> for each item</p>
                    <div class="format-detail">
                        <h4>Structure</h4>
                        <pre>type: ordering
@STEM
&lt;question&gt;
@CHOICES
- &lt;item 1 (first)&gt;
- &lt;item 2&gt;
- &lt;item 3&gt;
- &lt;item 4 (last)&gt;</pre>
                        <h4>Example</h4>
                        <pre>type: ordering
@STEM
Arrange these historical events in chronological order (earliest first).
@CHOICES
- Invention of the Printing Press
- First Moon Landing
- Discovery of the Americas
- Industrial Revolution</pre>
                    </div>
                </div>
                <div class="format-card" data-type="gap">
                    <div class="format-card-header">
                        <span class="format-type">Gap Fill</span>
                        <span class="format-ar">(Gap Fill)</span>
                    </div>
                    <p class="format-desc"><span class="tag">@BLANK</span> for the gap, <span class="tag">@GAPS</span> list of choices</p>
                    <div class="format-detail">
                        <h4>Structure</h4>
                        <pre>type: gap
@STEM
&lt;sentence with @BLANK&gt;
@GAPS
* &lt;correct answer&gt;
- &lt;distractor&gt;</pre>
                        <h4>Example</h4>
                        <pre>type: gap
@STEM
Photosynthesis is the process by which @BLANK use sunlight to synthesize nutrients from @BLANK and water.
@GAPS
* plants
* carbon dioxide
- animals
- oxygen</pre>
                    </div>
                </div>
                <div class="format-card" data-type="frq">
                    <div class="format-card-header">
                        <span class="format-type">FRQ</span>
                        <span class="format-ar">(Free Response)</span>
                    </div>
                    <p class="format-desc"><span class="tag">@ANSWER</span> with <span class="tag">type: frq</span></p>
                    <div class="format-detail">
                        <h4>Structure</h4>
                        <pre>type: frq
@STEM
&lt;question&gt;
@ANSWER &lt;model answer&gt;</pre>
                        <h4>Example</h4>
                        <pre>type: frq
@STEM
If a rectangle has a length of 5cm and a width of 4cm, what is its area in square centimeters?
@ANSWER 20</pre>
                    </div>
                </div>
                <div class="format-card" data-type="input">
                    <div class="format-card-header">
                        <span class="format-type">Input</span>
                        <span class="format-ar">(Numeric Input)</span>
                    </div>
                    <p class="format-desc"><span class="tag">@ANSWER</span> then the value</p>
                    <div class="format-detail">
                        <h4>Structure</h4>
                        <pre>type: input
@STEM
&lt;question&gt;
@ANSWER
&lt;value&gt;</pre>
                        <h4>Example</h4>
                        <pre>type: input
@STEM
Solve for x: 2x + 5 = 15
@ANSWER
5</pre>
                    </div>
                </div>
                <div class="format-card" data-type="counting">
                    <div class="format-card-header">
                        <span class="format-type">Counting</span>
                        <span class="format-ar">(Counting)</span>
                    </div>
                    <p class="format-desc"><span class="tag">@ANSWER</span> &lt;value&gt; | &lt;unit&gt;</p>
                    <div class="format-detail">
                        <h4>Structure</h4>
                        <pre>type: counting
@STEM
&lt;question&gt;
@ANSWER
&lt;value&gt; | &lt;unit&gt;</pre>
                        <h4>Example</h4>
                        <pre>type: counting
@STEM
How many sides does a hexagon have?
@ANSWER
6 | sides</pre>
                    </div>
                </div>
                <div class="format-card" data-type="opinion">
                    <div class="format-card-header">
                        <span class="format-type">Opinion</span>
                        <span class="format-ar">(Opinion)</span>
                    </div>
                    <p class="format-desc"><span class="tag">@CHOICES</span> with <span class="tag">-</span> for each option</p>
                    <div class="format-detail">
                        <h4>Structure</h4>
                        <pre>type: opinion
@STEM
&lt;question&gt;
@CHOICES
- &lt;option 1&gt;
- &lt;option 2&gt;
- &lt;option 3&gt;
- &lt;option 4&gt;
- &lt;option 5&gt;</pre>
                        <h4>Example</h4>
                        <pre>type: opinion
@STEM
Which of these school subjects do you find most interesting?
@CHOICES
- Mathematics
- Science
- History
- Art
- Physical Education</pre>
                    </div>
                </div>
            </div>

            <h3>Input (Numeric)</h3>
            <p>Unit is optional after <code>|</code> in the answer, e.g.: <code>15 | cm</code></p>

            <h3>Opinion</h3>
            <p>No correct or incorrect answers — all choices use <code>-</code></p>

            <h3>Additional Types</h3>
            <ul>
                <li><strong>FRQ AI:</strong> <code>type: frq</code> then in preview select the appropriate Template ID (especially for English subjects)</li>
                <li><strong>GMRQ:</strong> Two groups separated by <code>---</code> inside @CHOICES</li>
                <li><strong>Counting:</strong> <code>type: counting</code> with <code>@ANSWER</code> like <code>5 | oranges</code></li>
                <li><strong>@POEM and @END_POEM:</strong> For poetic text — place verses between them</li>
                <li><strong>@ALTTEXT and @GRAPHIC_NOTE:</strong> For placeholder images — can be used in @STEM, @CHOICES, or @MATCHING_PAIRS</li>
                <li><strong>Matching with images:</strong> Example of matching with @ALTTEXT and @GRAPHIC_NOTE in pairs:
                    <pre class="code-block">type: matching
@STEM
Drag to sort the needs and wants.
@MATCHING_PAIRS
Need | @ALTTEXT: Illustration of a clear plastic water bottle filled with still water, featuring a blue cap and a ribbed texture on the plastic.
@GRAPHIC_NOTE: https://content.nagwa.com/pictograms/info/587175432682
Want | @ALTTEXT: Illustration of a plastic soda bottle containing a dark brown carbonated liquid, featuring a red cap and a red label.
@GRAPHIC_NOTE: https://content.nagwa.com/pictograms/info/783146169859</pre>
                </li>
                <li><strong>Single Question with Custom ID:</strong> When you provide an <code>id</code> for a single question, that ID is registered and used in the final JSON and for numbering associated media files:
                    <pre class="code-block">type: mcq
id: 887766554433
@STEM
What is the capital of France?
@CHOICES
* Paris
- Lyon
- Nice</pre>
                </li>
                <li><strong>@ar (English + Arabic):</strong> For bilingual questions — English then <code>@ar</code> then Arabic; generates two linked questions (en and ar):
                    <pre class="code-block">type: mcq
id: 112233445566
@STEM
What is 5 + 5?
@CHOICES
* 10
- 15
@ar
@STEM
ما حاصل جمع 5 + 5؟
@CHOICES
* 10
- 15</pre>
                </li>
                <li><strong>Multi-Part:</strong> Use <code>parent_id</code>, <code>@STATEMENT</code>, and <code>@PART</code> for each sub-question:
                    <pre class="code-block">parent_id: 358146352767
@STATEMENT
أوجد ناتج: ١٥ − ٧.
@PART
type: mcq
@STEM
قسِّم العدد ٧ إلى@BLANK و@BLANK .
@CHOICES
*٥ و ٢
- ٦و ١
- ٤ و ٣
@PART
type: mcq
@STEM
اطرح ٥ ثم ٢. الناتج هو@BLANK .
@CHOICES
*٨
-٧
-٩</pre>
                    <p class="format-hint"><strong>Key rules:</strong> Put <code>parent_id</code> and global metadata before any <code>@</code> tags. Each sub-question starts with <code>@PART</code>. Use <code>@BLANK</code> for gaps.</p>
                </li>
                <li><strong>Puzzle:</strong> See question_structures.md for full formats</li>
            </ul>

            <h3>Additional Notes</h3>
            <ul>
                <li><strong>Metadata:</strong> You can add <code>id: 1001</code> or <code>language: ar</code> at the start of a question (most are ignored except type)</li>
                <li><strong>Math equations:</strong> Use <code>$x^2$</code> or <code>`x^2`</code> for formulas</li>
                <li><strong>Images:</strong> Image URLs can be placed inside @STEM or @CHOICES</li>
                <li><strong>Common mistakes:</strong> Forgetting <code>*</code> for the correct answer, or writing <code>@stem</code> in lowercase (must be <code>@STEM</code>)</li>
            </ul>
        </section>

        <!-- Section 5: Editor -->
        <section id="editor" class="card section-card">
            <div class="card-number">5</div>
            <h2>Rich Text Editor and Tools</h2>
            
            <h3>Paragraph and Font Formatting</h3>
            <p><strong>Heading Style:</strong> Normal, Heading 1, Heading 3. <strong>Font Family:</strong> Inherit or Courier New.</p>

            <h3>Toolbar</h3>
            <div class="table-wrap">
                <table class="content-table">
                    <thead>
                        <tr><th><i data-lucide="wrench" class="inline-icon"></i> Tool</th><th><i data-lucide="zap" class="inline-icon"></i> Function</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><i data-lucide="undo-2" class="inline-icon"></i> / <i data-lucide="redo-2" class="inline-icon"></i></td><td>Undo / Redo (Ctrl+Z / Ctrl+Y)</td></tr>
                        <tr><td>B, I, U, S</td><td>Bold (Ctrl+B), Italic (Ctrl+I), Underline (Ctrl+U), Strikethrough</td></tr>
                        <tr><td>List Style</td><td>Normal, Bulleted List, Numbered List</td></tr>
                        <tr><td>A button</td><td>Text color and highlight. Reset/None to remove formatting</td></tr>
                        <tr><td>X₂ / X²</td><td>Subscript / Superscript</td></tr>
                        <tr><td>-Σ- / Σ</td><td>Insert inline equation (Inline Math) / Block equation (Block Math)</td></tr>
                        <tr><td><i data-lucide="table" class="inline-icon"></i></td><td>Insert table — specify rows and columns, (optional) Header Row, Insert. After insert: right-click to add rows/columns, alignment, background color, delete</td></tr>
                        <tr><td><i data-lucide="image" class="inline-icon"></i> / <i data-lucide="music" class="inline-icon"></i> / <i data-lucide="file-text" class="inline-icon"></i> / <i data-lucide="minus" class="inline-icon"></i></td><td>Image (URL or upload), audio, poem (@POEM and @END_POEM), gap (Gap/Blank)</td></tr>
                        <tr><td><i data-lucide="list-indent-increase" class="inline-icon"></i> / <i data-lucide="list-indent-decrease" class="inline-icon"></i></td><td>Decrease / Increase indent</td></tr>
                        <tr><td>LTR / RTL</td><td>Text direction: Left-to-right / Right-to-left</td></tr>
                        <tr><td><i data-lucide="align-left" class="inline-icon"></i> <i data-lucide="align-center" class="inline-icon"></i> <i data-lucide="align-right" class="inline-icon"></i> <i data-lucide="align-justify" class="inline-icon"></i></td><td>Alignment: Left, Center, Right, Justify</td></tr>
                    </tbody>
                </table>
            </div>

            <h3>Placeholder Images</h3>
            <p>To describe an image without an actual file: <code>@ALTTEXT image description @GRAPHIC_NOTE optional note</code></p>

            <h3>Manage Tags</h3>
            <p>The <strong><i data-lucide="tag" class="inline-icon"></i> Manage Tags</strong> button opens a window with ready templates and tags (@STEM, @CHOICES, @ANSWER...) for quick insertion.</p>

            <h3>Usage Tips</h3>
            <ul>
                <li><strong>Paste:</strong> Editor preserves formatting and tags when pasting from external sources</li>
                <li><strong>Equations:</strong> Use MathLive for correct math input</li>
                <li><strong>Arabic:</strong> Choose RTL to ensure correct text direction</li>
                <li><strong>Embedded images:</strong> Uploaded images are stored and renamed on export (e.g., {questionId}.01.png)</li>
            </ul>

            <h3>Do I Need Rich Formatting?</h3>
            <p><strong>For preview and export:</strong> Yes, formatting is included in the final JSON. <strong>For simple tags:</strong> Plain text with @STEM and @CHOICES is enough.</p>
        </section>

        <!-- Section 6: Preview -->
        <section id="preview" class="card section-card">
            <div class="card-number">6</div>
            <h2>Preview and Verification</h2>
            
            <h3>Analysis Step</h3>
            <ol>
                <li>Enter or paste questions in the editor</li>
                <li>Press the <strong><i data-lucide="eye" class="inline-icon"></i> Preview Questions</strong> button</li>
                <li>Questions are analyzed and appear in the right panel</li>
            </ol>

            <h3>What Happens?</h3>
            <ul>
                <li>The parser splits questions by <code>---</code></li>
                <li>Recognizes tags (@STEM, @CHOICES...) and each question type</li>
                <li>Displays each question with: question type, question text and choices/answer, dropdown to change type</li>
            </ul>

            <h3>Preview Panel Elements</h3>
            <ul>
                <li>Question number or order</li>
                <li>Question type (editable dropdown)</li>
                <li>Question content as it will appear in JSON</li>
                <li>Any warnings or errors related to the question</li>
            </ul>

            <h3>Subject Template ID</h3>
            <p>For FRQ AI questions and English subjects: A <strong>Select subject to apply Template ID</strong> window appears. It opens from the app interface (customize button or preview panel) after analyzing questions. Select the subject and grade then press <strong>Apply</strong>. When English and grade are selected, a Template ID list appears above each frq_ai question. You can change the Template ID for each question individually.</p>

            <h3>Ordering Question Display Direction</h3>
            <p>For <strong>Ordering</strong> questions, a dropdown appears to choose display direction (vertical or horizontal).</p>

            <h3>Live Preview</h3>
            <p>The <strong>Live Preview</strong> button appears after analysis and displays questions with the Nagwa engine.</p>

            <h3>Edit and Delete</h3>
            <p><i data-lucide="pencil" class="inline-icon"></i> and <i data-lucide="trash-2" class="inline-icon"></i> buttons next to each question in the preview for editing or deleting.</p>

            <h3>Question Validation</h3>
            <p>Before export ensure: Section ID is set and Fetch succeeded, all questions have the correct type, no error messages, and Template ID is selected for FRQ AI questions if needed.</p>

            <h3>Notes</h3>
            <ul>
                <li>Any text change requires pressing <strong>Preview Questions</strong> again</li>
                <li>Warnings may appear (missing image, incomplete answer) — review before export</li>
                <li>Creating JSON or ZIP depends on the last successful analysis</li>
                <li>A count of analyzed questions is shown</li>
            </ul>
        </section>

        <!-- Section 7: Media -->
        <section id="media" class="card section-card">
            <div class="card-number">7</div>
            <h2>Media and Files (Images and Audio)</h2>
            
            <p>You can add images to any part of a question (@STEM, @CHOICES, @MATCHING_PAIRS).</p>

            <h3>How to Insert Images</h3>
            <p><strong>a. Using the toolbar (easiest):</strong></p>
            <ol>
                <li>Place the cursor where you want to insert the image</li>
                <li>Click the <i data-lucide="image" class="inline-icon"></i> icon in the toolbar</li>
                <li>A window appears: upload file or paste URL</li>
                <li>Press Insert. The editor automatically creates the image code</li>
            </ol>
            <p><strong>b. Manual entry:</strong> <code>&lt;img src="url" alt="description" width="300"&gt;</code> or with <code>num="1"</code> to link images to export files. The system renames on export (e.g., questionId.01.png).</p>

            <h3>Placeholder Images (Virtual Images)</h3>
            <p>For a placeholder image the design team will create later, or to describe a non-existent image, use <code>@ALTTEXT</code>. On export it is treated as an attached image but no actual image file is created.</p>

            <h3>Audio</h3>
            <p>Used in listening questions. Use the <code>&lt;audio&gt;</code> tag with <code>num</code> and <code>transcript</code>:</p>
            <pre class="code-block">&lt;audio num="1" transcript="Transcript text"&gt;
Your browser does not support audio playback.
&lt;/audio&gt;</pre>
            <p><strong>num="1":</strong> Export filename will be questionId.01.mp3. <strong>transcript:</strong> For transcript text (accessibility or grading).</p>

            <h3>Complete Examples</h3>
            <p><strong>MCQ with image:</strong> Place <code>&lt;img src="..."&gt;</code> inside @STEM.</p>
            <p><strong>Listening question:</strong> Place <code>&lt;audio num="1" transcript="..."&gt;</code> in @STEM.</p>
            <p><strong>Images in choices:</strong> Use <code>&lt;img src="..."&gt;</code> inside each choice in @CHOICES.</p>

            <h3>Export Notes</h3>
            <ul>
                <li><strong>File naming:</strong> On Export Package (ZIP), images and audio are renamed (e.g., temp_123_01.png)</li>
                <li><strong>Uploaded images:</strong> Stored temporarily in the browser. Exporting the package (ZIP) saves them permanently</li>
                <li><strong>External links:</strong> Images with HTTP URLs remain as links; they won't be included in the ZIP unless uploaded locally (Base64/Blob)</li>
            </ul>
        </section>

        <!-- Section 8: Export -->
        <section id="export" class="card section-card">
            <div class="card-number">8</div>
            <h2>Export and Final Output</h2>
            
            <h3>Prerequisites</h3>
            <ol>
                <li>Section ID and Fetch</li>
                <li>Preview Questions</li>
                <li>Review the preview</li>
            </ol>

            <h3>Create JSON File</h3>
            <p>1. Press <strong><i data-lucide="file-code" class="inline-icon"></i> Create JSON File</strong>. 2. A JSON Output window opens showing formatted content. 3. <strong><i data-lucide="copy" class="inline-icon"></i> Copy JSON</strong> copies to clipboard, <strong><i data-lucide="x" class="inline-icon"></i> Close</strong> closes the window. For a downloadable JSON file with media, use <strong>Export Package (ZIP)</strong>.</p>
            <p><strong>Exported content:</strong> Array of question objects in Nagwa format (id, type, stem, choices/answer, metadata). Images and audio use names like {questionId}.01.png</p>

            <h3>Export Package (ZIP)</h3>
            <p>After analysis the button changes from disabled to active. Press to download a ZIP containing: JSON file, images folder, audio folder. Suitable for uploading a full set to Nagwa at once.</p>

            <h3>Copy JSON to Clipboard</h3>
            <p>From the JSON Output window press <strong><i data-lucide="copy" class="inline-icon"></i> Copy JSON</strong> — copies in full and can be pasted into an editor or other file.</p>

            <h3>CSV Editor</h3>
            <p>For controlling export data. Columns: <strong>Question Id</strong>, <strong>Lang</strong> (content language), <strong>Section Id</strong>, <strong>Attributes</strong> (question part types), <strong>Subject</strong>, <strong>Source</strong> (e.g., nagwa). Opens from the app interface after analysis. Data is saved to local storage and used when creating JSON or ZIP.</p>

            <h3>File Naming</h3>
            <p><strong>Images:</strong> <code>{questionId}.{num}.{ext}</code> (e.g., temp_1234567890_01.png). <strong>Audio:</strong> <code>{questionId}.{num}.mp3</code></p>

            <h3>Placeholder Images in Export</h3>
            <p>Tags like @alttext or @graphic_note are included in JSON as references — no actual image file is created in the package.</p>

            <h3>What's the Difference Between Create JSON and Export Package?</h3>
            <p><strong>Create JSON File:</strong> Window with JSON content for copying — good for manual editing. Does not include separate media files. <strong>Export Package (ZIP):</strong> Downloads a ready-to-upload ZIP — includes JSON + images + audio + CSV. Good for direct upload to Nagwa.</p>

            <h3>Recommended Workflow</h3>
            <ol>
                <li>Set up Section ID and Fetch</li>
                <li>Enter and format questions</li>
                <li>Preview Questions and review</li>
                <li>Adjust question types and Template ID if needed</li>
                <li>Create JSON or Export Package</li>
            </ol>
        </section>

        <!-- Section 9: Troubleshooting -->
        <section id="troubleshooting" class="card section-card">
            <div class="card-number">9</div>
            <h2>Tips and Troubleshooting</h2>
            
            <h3>Quick Check</h3>
            <ol>
                <li>Did you run Preview Questions before export?</li>
                <li>Is Section ID entered and Fetch successful?</li>
                <li>Are tags in uppercase (<code>@STEM</code> not <code>@stem</code>)?</li>
                <li>Is the correct answer prefixed with <code>*</code>?</li>
            </ol>

            <h3>Common Errors and Solutions</h3>
            <div class="troubleshoot-list">
                <div class="trouble-item">
                    <i data-lucide="alert-circle" class="trouble-icon"></i>
                    <div><strong>"Please analyze questions first"</strong> — Press Preview Questions first.</div>
                </div>
                <div class="trouble-item">
                    <i data-lucide="alert-circle" class="trouble-icon"></i>
                    <div><strong>Export Package disabled</strong> — Requires a successful analysis first.</div>
                </div>
                <div class="trouble-item">
                    <i data-lucide="alert-circle" class="trouble-icon"></i>
                    <div><strong>Section Fetch fails</strong> — Check internet connection and Section ID validity.</div>
                </div>
                <div class="trouble-item">
                    <i data-lucide="alert-circle" class="trouble-icon"></i>
                    <div><strong>Wrong question type</strong> — Change it from the dropdown in the preview.</div>
                </div>
                <div class="trouble-item">
                    <i data-lucide="alert-circle" class="trouble-icon"></i>
                    <div><strong>@POEM and @END_POEM mismatch</strong> — Close every @POEM with @END_POEM.</div>
                </div>
                <div class="trouble-item">
                    <i data-lucide="alert-circle" class="trouble-icon"></i>
                    <div><strong>Tags not recognized</strong> — Use uppercase: @STEM, @CHOICES, @ANSWER.</div>
                </div>
                <div class="trouble-item">
                    <i data-lucide="alert-circle" class="trouble-icon"></i>
                    <div><strong>Correct answer not specified</strong> — Use <code>*</code> for correct and <code>-</code> for incorrect.</div>
                </div>
                <div class="trouble-item">
                    <i data-lucide="alert-circle" class="trouble-icon"></i>
                    <div><strong>API Keys</strong> — Verify key and quota (Gemini or OpenAI).</div>
                </div>
                <div class="trouble-item">
                    <i data-lucide="alert-circle" class="trouble-icon"></i>
                    <div><strong>Create AI requires Section ID</strong> — Enter Section ID and press Fetch first.</div>
                </div>
                <div class="trouble-item">
                    <i data-lucide="alert-circle" class="trouble-icon"></i>
                    <div><strong>Images don't display</strong> — Use stable URLs or upload via the insert button.</div>
                </div>
                <div class="trouble-item">
                    <i data-lucide="alert-circle" class="trouble-icon"></i>
                    <div><strong>Math equations don't display correctly</strong> — Use the -Σ- or Σ insert button instead of manual LaTeX, and ensure the equation is closed in the MathLive window.</div>
                </div>
            </div>

            <h3>Solution Details</h3>
            <p><strong>Section Fetch fails:</strong> Check internet, Section ID validity (numbers only), local server running (python server.py or npm run dev).</p>
            <p><strong>Tags not recognized:</strong> Use uppercase @STEM, @CHOICES, @ANSWER, and ensure no spaces before or after the tag.</p>
            <p><strong>Correct answer:</strong> <code>* Paris</code> ← correct. <code>- Lyon</code> ← incorrect.</p>

            <h3>General Tips</h3>
            <ul>
                <li>Save a copy of the text before clearing</li>
                <li>Test with a simple MCQ first</li>
                <li>Use Live Preview before export</li>
                <li>Split long question sets into batches</li>
                <li>Use a modern browser (Chrome, Firefox, Edge)</li>
                <li>Content is auto-saved in the browser</li>
            </ul>
        </section>

        <!-- Section 10: Links -->
        <section id="links" class="card section-card">
            <div class="card-number">10</div>
            <h2>Links</h2>
            <p>Quick access to related platforms:</p>
            <div class="links-grid">
                <a href="https://qms.nagwa.com/" target="_blank" rel="noopener noreferrer" class="link-item" title="Nagwa QMS">
                    <img src="assts/qms.svg" alt="Nagwa QMS">
                    <span class="link-item__text">Nagwa QMS</span>
                </a>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>User Guide — Question to JSON Converter</p>
        <p class="footer-refs">For full question type reference see question_structures.md. For image and audio behavior see system_behavior_guide.md.</p>
    </footer>

    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
